{% extends 'shop/base.html' %}
{% load static %}

{% block css %}
  <link rel="stylesheet" href="{% static "css/cart_detail.css" %}">
{% endblock %}

{% block title %}
  سبد خرید | سوپرمارکت اینترنتی پلنوم
{% endblock %}

{% block content %}
  <div class="cart">
    {% for item in cart %}
      {% with product=item.product %}
        <a href="{{ product.get_absolute_url }}">
          <img src="{% if product.image %}{{ product.image.url }}{% else %}{% static 'media/image/no_image_available/no_image_available.png' %}{% endif %}" alt="an image of {{ product.name }}">
        </a>
        <a class="product_link" href="{{ product.get_absolute_url }}">{{ product.name }}</a>
        <p id="num">{{ item.price }} تومان</p>
        <form action="{% url "cart:cart_add" product.id %}" method="post">
          {{ item.update_quantity_form.quantity }}
          {{ item.update_quantity_form.update }}
          {% csrf_token %}
        </form>
        <a href="{% url "cart:cart_remove" product.id %}"><i class="fas fa-times"></i></a>
        <p id="total_num">قیمت نهایی: {{ item.total_price }} تومان</p>
      {% endwith %}
    {% endfor %}
    <hr>
    <p id="sum_total_num">مجموع قیمت سبد خرید: {{ cart.get_total_price }} تومان</p>
  </div>
  <a id="button" href="{% url "orders:order_authenticate" %}"><div class="button-text">ثبت سفارش</div></a>
{% endblock %}
